/**
 * ARCHITECTURAL: XBlock structural styles only
 *
 * Paragon CSS is loaded from CDN at runtime (via Python fragment)
 * This file contains ONLY XBlock-specific layout and structural styles
 * Use CSS variables for colors (--pgn-color-*) to respect theme
 */

@import '../../../../../shared/styles/liverpool-shared-tokens';

// IMPLEMENTATION: Import Paragon components used in studio view

// IMPLEMENTATION: Your custom styles below
.accordion-studio-view {
  // Add horizontal padding to prevent content touching edges
  padding-left: 3rem;
  padding-right: 3rem;

  // Ensure the view takes full height and pushes sticky actions to bottom
  min-height: 100%;
  display: flex;
  flex-direction: column;

  // Form should also be flex container
  > form {
    display: flex;
    flex-direction: column;
    flex: 1;
  }

  // Consistent typography
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;

  // Main heading for card count - Paragon h3 scaled for 10px modal base
  // Paragon intent: $h3-font-size: 1.375rem (22px at 16px base)
  // Modal base: 10px, so 2.2rem × 10px = 22px
  h3 {
    font-size: 2.2rem;
    font-weight: 700;
    margin-bottom: 1rem;
    margin-top: 0;
  }

  // Section headings inside accordion - Paragon h4 scaled for 10px modal base
  // Paragon intent: $h4-font-size: 1.125rem (18px at 16px base)
  // Modal base: 10px, so 1.8rem × 10px = 18px
  h4 {
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 0.75rem;
    margin-top: 0;
  }

  // Form labels - Paragon input size scaled for 10px modal base
  // Paragon intent: $input-font-size: 1.125rem (18px at 16px base)
  // Modal base: 10px, so 1.8rem × 10px = 18px
  .pgn__form-label,
  label {
    font-size: 1.8rem;
    font-weight: 500;
    margin-bottom: 0.5rem;
  }

  // Collapsible buttons - scaled for 10px modal base
  .collapsible-trigger,
  .pgn__collapsible-trigger {
    font-size: 1.8rem;
  }

  // Button text - Paragon button size scaled for 10px modal base
  // Paragon intent: $input-btn-font-size: 1.125rem (18px at 16px base)
  // Modal base: 10px, so 1.8rem × 10px = 18px
  .btn {
    font-size: 1.8rem;
  }

  // ========================================
  // LIST VIEW STYLING - Professional OpenEdX Style
  // ========================================

  .accordion-list-view {
    flex: 1; // Grow to fill available space, pushing sticky actions to bottom

    .card-list {
      display: flex;
      flex-direction: column;
      gap: 0;
    }

    .card-list-item {
      display: flex;
      align-items: flex-start;
      gap: 1.2rem;
      padding: 1.5rem 0;
      border-bottom: 1px solid #e9ecef;

      &:last-child {
        border-bottom: none;
      }
    }

    .card-drag-handle {
      color: #adb5bd;
      cursor: grab;
      padding-top: 0.3rem;
      flex-shrink: 0;
      user-select: none;

      .pgn__icon {
        width: 2rem;
        height: 2rem;
      }

      &:hover {
        color: var(--pgn-color-text-secondary, #6c757d);
      }

      &:active {
        cursor: grabbing;
      }
    }

    // Dragging state
    .card-list-item.dragging {
      opacity: 0.5;
      cursor: grabbing;
    }

    // Drag over state - show where the card will drop (Liverpool blue)
    .card-list-item.drag-over {
      border-top: $liverpool-drag-over-border;
    }

    .card-content {
      flex: 1;
      min-width: 0;
    }

    .card-main {
      margin-bottom: 0.5rem;
    }

    .card-label {
      font-weight: 600;
      color: var(--pgn-color-text-secondary, #495057);
      font-size: 1.4rem;
      margin-right: 0.5rem;
    }

    .card-title {
      font-size: 1.4rem;
      color: var(--pgn-color-text-base, #212529);
    }

    .card-subtitle {
      font-size: 1.3rem;
      color: var(--pgn-color-text-secondary, #6c757d);
      margin-bottom: 0.5rem;
      line-height: 1.4;
    }

    .card-back-preview {
      font-size: 1.2rem;
      color: #868e96;
      line-height: 1.4;
    }

    .card-actions {
      display: flex;
      gap: 1.5rem;
      flex-shrink: 0;
      padding-top: 0.3rem;

      .btn-link {
        font-size: 1.3rem;
        padding: 0;

        &.text-danger:disabled {
          opacity: 0.4;
        }
      }
    }
  }

  // ========================================
  // EDIT VIEW STYLING - Professional OpenEdX Style
  // ========================================

  .accordion-edit-view {
    flex: 1; // Grow to fill available space, pushing sticky actions to bottom

    .edit-header {
      h3 {
        margin: 0;
        color: var(--pgn-color-text-base, #212529);
        font-weight: 600;
      }
    }

    .form-section {
      // Clean sections with just spacing, no backgrounds or borders
    }

    .section-label {
      font-weight: 700;
      color: var(--pgn-color-text-base, #212529);
      font-size: 1.6rem;
      margin: 0;
    }

    .pgn__form-label {
      font-weight: 500;
      color: var(--pgn-color-text-secondary, #495057);
    }

    .form-text {
      font-size: 1.2rem;
    }
  }

  // ========================================
  // LIVERPOOL BUTTON STYLING
  // ========================================

  // Primary buttons - Liverpool pill-shaped with shadows
  .btn-primary {
    border-radius: $liverpool-btn-border-radius !important;
    box-shadow: $liverpool-btn-primary-shadow !important;
    background-color: $liverpool-blue !important;
    border-color: $liverpool-blue !important;
    color: white !important;
    transition: transform 0.2s ease, box-shadow 0.2s ease, background-color 0.2s ease !important;
    transform: scale(1);
    cursor: pointer;
    padding: 0.75rem 1.5rem !important;

    &:hover:not(:disabled) {
      transform: scale(1.05);
      box-shadow: $liverpool-btn-primary-shadow-hover !important;
      background-color: $liverpool-blue-dark !important;
      border-color: $liverpool-blue-dark !important;
      color: white !important;
    }

    &:active:not(:disabled) {
      transform: scale(0.98);
      box-shadow: $liverpool-btn-primary-shadow-active !important;
    }

    &:focus {
      box-shadow: $liverpool-btn-primary-shadow, $liverpool-shadow-focus !important;
      outline: none;
    }

    &:disabled {
      background-color: $liverpool-neutral-500 !important;
      border-color: $liverpool-neutral-500 !important;
      box-shadow: none !important;
      transform: none !important;
      cursor: not-allowed;
      opacity: 0.6;
    }
  }

  // Outline buttons - Liverpool blue outline
  .btn-outline-primary {
    border-radius: $liverpool-btn-border-radius !important;
    background-color: transparent !important;
    color: $liverpool-blue !important;
    border: 2px solid $liverpool-blue !important;
    padding: 0.5rem 1.25rem !important;
    cursor: pointer;
    transition: all 0.2s ease !important;

    &:hover:not(:disabled) {
      background-color: $liverpool-blue !important;
      color: white !important;
      border-color: $liverpool-blue !important;
    }

    &:focus {
      box-shadow: $liverpool-input-shadow-focus !important;
      outline: none !important;
    }

    &:disabled {
      background-color: transparent !important;
      border-color: $liverpool-neutral-500 !important;
      color: $liverpool-neutral-500 !important;
      cursor: not-allowed;
      opacity: 0.6;
    }
  }

  // Link buttons (Edit/Delete) - Liverpool blue
  .btn-link {
    color: $liverpool-blue !important;
    text-decoration: none !important;

    &:hover:not(:disabled) {
      color: $liverpool-blue-dark !important;
      text-decoration: underline !important;
    }

    &.text-danger {
      color: #dc3545 !important;

      &:hover:not(:disabled) {
        color: #c82333 !important;
      }
    }
  }

  // ========================================
  // LIVERPOOL FORM CONTROL STYLING
  // ========================================

  // Text inputs, textareas - Liverpool blue focus
  .form-control,
  .pgn__form-control,
  input[type="text"],
  textarea {
    border-radius: 0.375rem !important;

    &:focus {
      border-color: rgba(33, 43, 88, 0.5) !important;
      box-shadow: $liverpool-input-shadow-focus !important;
      outline: 0 !important;
    }
  }

  // ========================================
  // GENERAL STYLING
  // ========================================

  // Empty state
  .bg-light {
    background-color: var(--pgn-color-bg-subtle, #f8f9fa);
  }

  // ========================================
  // STICKY ACTION BUTTONS
  // ========================================

  // Make action buttons sticky at bottom so they're always visible
  .accordion-sticky-actions {
    position: sticky;
    bottom: 0;
    background-color: var(--pgn-color-bg-base, #ffffff);
    z-index: 100;
    margin-left: -3rem;  // Extend to full width (compensate for container padding)
    margin-right: -3rem;
    margin-top: 2rem;
    padding-left: 3rem;
    padding-right: 3rem;
    padding-bottom: 1.5rem;
    padding-top: 1.5rem;
    box-shadow: $liverpool-sticky-action-shadow;
    // RESPONSIVE: Prevent double-tap zoom on touch devices
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
  }

  // ========================================
  // RESPONSIVE DESIGN - Tablet Support
  // ========================================

  // RESPONSIVE: Tablet (481-768px)
  @media (max-width: 768px) and (min-width: 481px) {
    padding-left: 2rem;
    padding-right: 2rem;

    .accordion-sticky-actions {
      margin-left: -2rem;
      margin-right: -2rem;
      padding-left: 2rem;
      padding-right: 2rem;
    }

    // RESPONSIVE: Touch-friendly button sizing
    .btn {
      min-height: 44px;
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
    }

    .accordion-list-view {
      .card-list-item {
        flex-wrap: wrap;

        .card-actions {
          .btn-link {
            min-height: 44px;
            padding: 0.5rem;
          }
        }
      }
    }
  }

  // RESPONSIVE: Mobile (<481px) - Limited support (Studio mainly for desktop)
  @media (max-width: 480px) {
    padding-left: 1rem;
    padding-right: 1rem;

    h3 {
      font-size: 1.8rem;
    }

    h4 {
      font-size: 1.6rem;
    }

    .pgn__form-label,
    label {
      font-size: 1.6rem;
    }

    .accordion-sticky-actions {
      margin-left: -1rem;
      margin-right: -1rem;
      padding-left: 1rem;
      padding-right: 1rem;

      .btn {
        font-size: 1.6rem;
        min-height: 48px;
        padding: 0.75rem 1rem;
      }
    }

    .accordion-list-view {
      .card-list-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 1rem;

        .card-drag-handle {
          padding-top: 0;
        }

        .card-actions {
          width: 100%;
          justify-content: flex-start;

          .btn-link {
            min-height: 48px;
            padding: 0.75rem 1rem;
            font-size: 1.4rem;
          }
        }
      }
    }
  }
}

// Hide Studio's modal action buttons (Save/Close) for accordion
// We provide our own buttons with clearer labels
.modal-type-accordion .modal-actions {
  display: none !important;
}

// Hide the action-cancel close button
.modal-type-accordion .action-cancel {
  display: none !important;
}

// Hide any close buttons in header as well
.modal-type-accordion .modal-header .close,
.modal-type-accordion .modal-header .btn-close {
  display: none !important;
}

// Make the xblock wrappers fill modal height so sticky actions work
.modal-type-accordion .modal-content {
  display: flex;
  flex-direction: column;
  min-height: 502px; // Match OpenEdX modal min-height
}

.modal-type-accordion .modal-body {
  display: flex;
  flex-direction: column;
  flex: 1;
}

.modal-type-accordion .xblock-editor,
.modal-type-accordion .xblock {
  display: flex;
  flex-direction: column;
  flex: 1;
}
