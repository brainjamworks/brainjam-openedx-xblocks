/**
 * Timeline Presentation XBlock Studio Editor Layout
 *
 * Beautiful three-column grid layout for fullscreen modal (98vh Ã— 98vw)
 * Hides OpenEdX modal chrome to maximize usable space
 */

@import './liverpool-tokens.scss';

// =============================================================================
// HIDE OPENEDX MODAL CHROME (COMMENTED OUT FOR DEBUGGING)
// =============================================================================

// TODO: Re-enable fullscreen modal once we debug the rendering issues
// These changes were causing the content to not display properly

/*
// Hide default modal header and action buttons for timeline_presentation category
// NOTE: Using underscore to match Python category = "timeline_presentation"
// Using high-specificity selector to override OpenEdX defaults
.modal-window.modal-type-timeline_presentation .edit-xblock-modal .modal-header,
.modal-window.modal-type-timeline_presentation .edit-xblock-modal .modal-actions {
  display: none !important;
}

// Make modal content fill available space
.modal-type-timeline_presentation .modal-content {
  display: flex !important;
  flex-direction: column !important;
  height: 100% !important;
  padding: 0 !important;
}

// Ensure our editor fills the modal
.modal-type-timeline_presentation .xblock-studio_view {
  display: flex;
  flex-direction: column;
  height: 100%;
  width: 100%;
  overflow: hidden;
}

// Remove padding from wrapper
.modal-type-timeline_presentation .wrapper-xblock {
  padding: 0 !important;
  margin: 0 !important;
}

// Maximize tab content height and remove default constraints
.modal-type-timeline_presentation .timeline-presentation-xblock-studio-view {
  height: 100%;
  display: flex;
  flex-direction: column;
  padding: 0 !important;        // Remove default padding
  max-width: none !important;   // Remove width constraint
  margin: 0 !important;          // Remove auto-centering
}

// Make Paragon Tabs take full height
.modal-type-timeline_presentation .pgn__tabs {
  height: 100%;
  display: flex;
  flex-direction: column;

  .nav-tabs {
    flex-shrink: 0;
    margin-bottom: 0 !important;
  }

  .tab-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;

    .tab-pane {
      height: 100%;
      display: flex;
      flex-direction: column;
      overflow: hidden;

      &.active {
        display: flex !important;
      }
    }
  }
}
*/

// =============================================================================
// THREE-COLUMN GRID LAYOUT
// =============================================================================

.timeline-editor-root {
  display: grid;
  grid-template-columns: $xblock-event-sidebar-width 1fr $xblock-properties-panel-width;
  grid-template-rows: 1fr auto; // main content + actions footer
  gap: $liverpool-space-4;
  height: 100%;
  width: 100%;
  padding: $liverpool-space-4;
  font-family: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  position: relative;
}

// =============================================================================
// COLUMN AREAS
// =============================================================================

.editor-left-column {
  grid-column: 1;
  grid-row: 1;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  min-height: 0; // Important for flexbox overflow
  border-radius: 20px;
  box-shadow: 0 4px 8px #0000001f;
}

.editor-center-column {
  grid-column: 2;
  grid-row: 1;
  display: flex;
  flex-direction: column;
  gap: $liverpool-space-4;
  min-height: 0; // Important for flexbox overflow
  min-width: 0;  // Prevents flex items from expanding beyond grid bounds
  // Invisible container - just for layout positioning
  // Individual cards have their own shadows
}

.editor-right-column {
  grid-column: 3;
  grid-row: 1;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  min-height: 0; // Important for flexbox overflow
  border-radius: 20px;
  box-shadow: 0 4px 8px #0000001f;
}

.editor-actions-row {
  grid-column: 1 / -1; // Span all columns
  grid-row: 2;
  flex-shrink: 0;
}

// =============================================================================
// TABS HEADER WRAPPER (contains tabs + close button)
// =============================================================================

.tabs-header-wrapper {
  position: relative;
  margin-bottom: 1.5rem;
}

// =============================================================================
// CLOSE BUTTON (positioned inline with tabs)
// =============================================================================

.tabs-close-button {
  position: absolute !important;
  top: 0;
  right: 0;
  z-index: 10;
  cursor: pointer;
  background: transparent !important;
  border: none !important;
  padding: 0 !important;

  svg {
    width: 24px;
    height: 24px;
    color: $liverpool-neutral-600;
  }
}

// =============================================================================
// RESPONSIVE ADJUSTMENTS
// =============================================================================

// Slightly narrower columns on smaller screens
@media (max-width: 1600px) {
  .timeline-editor-root {
    grid-template-columns: 260px 1fr 300px;
  }
}

// Minimum viable layout
@media (max-width: 1200px) {
  .timeline-editor-root {
    grid-template-columns: 240px 1fr 280px;
    gap: $liverpool-space-3;
    padding: $liverpool-space-3;
  }
}

// =============================================================================
// SMOOTH PAGE TRANSITIONS
// =============================================================================

.timeline-editor-root {
  animation: fadeIn 300ms $liverpool-transition-easing;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

// =============================================================================
// GLASSMORPHISM TABS - Matching LMS Course Tabs
// =============================================================================
// Subtle frosted glass pills matching Liverpool's LMS aesthetic
// =============================================================================

/* Main tabs container */
.timeline-presentation-xblock-studio-view .pgn__tabs {
  background: transparent !important;
  border-bottom: none !important;
  box-shadow: none !important;
  margin-bottom: 1.5rem !important;
}

/* Nav bar wrapper */
.timeline-presentation-xblock-studio-view .nav-tabs {
  margin-bottom: 0 !important;
  border-bottom: none !important;
  background: transparent !important;
}

/* Tab links - Subtle glass pills */
.timeline-presentation-xblock-studio-view .nav-link {
  /* Light frosted glass */
  background: rgba(255, 255, 255, 0.6) !important;
  backdrop-filter: blur(10px) saturate(120%) !important;
  -webkit-backdrop-filter: blur(10px) saturate(120%) !important;

  border: 1px solid rgba(0, 0, 0, 0.06) !important;
  border-radius: 14px !important;

  color: #333F48 !important;
  font-weight: 500 !important;
  font-size: 0.9375rem !important;

  padding: 0.625rem 1.25rem !important;
  margin: 0 0.25rem !important;

  /* Very subtle shadow */
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.03) !important;

  transition: all 150ms ease !important;
}

/* Hover state - slightly brighter */
.timeline-presentation-xblock-studio-view .nav-link:hover {
  background: rgba(255, 255, 255, 0.75) !important;
  border-color: rgba(0, 0, 0, 0.08) !important;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05) !important;
  color: #212b58 !important;
}

/* Active tab - Liverpool Blue glass tint */
.timeline-presentation-xblock-studio-view .nav-link.active {
  background: rgba(33, 43, 88, 0.12) !important;
  backdrop-filter: blur(15px) saturate(130%) !important;
  -webkit-backdrop-filter: blur(15px) saturate(130%) !important;

  border: 1px solid rgba(33, 43, 88, 0.2) !important;
  box-shadow:
    0 2px 8px rgba(33, 43, 88, 0.08),
    inset 0 1px 0 rgba(255, 255, 255, 0.4) !important;

  color: #15376D !important;
  font-weight: 600 !important;
}

/* Focus state - Liverpool teal outline */
.timeline-presentation-xblock-studio-view .nav-link:focus {
  outline: 2px solid #00A689 !important;
  outline-offset: 2px !important;
}

/* Responsive */
@media (max-width: 768px) {
  .timeline-presentation-xblock-studio-view .nav-link {
    font-size: 0.875rem !important;
    padding: 0.5rem 1rem !important;
    margin: 0 0.125rem !important;
    backdrop-filter: blur(8px) saturate(120%) !important;
    -webkit-backdrop-filter: blur(8px) saturate(120%) !important;
  }
}
